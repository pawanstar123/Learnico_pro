{% extends 'app.html' %}
{% block title %}Dashboard - Learnico{% endblock %}
{% block content %}

<div class="container" style="margin-top: 20px;">
    <h2 style="color: #6200ff; margin-bottom: 8px; font-size: 28px;">Learnico</h2>
    <p style="color: #666; margin-bottom: 20px; font-size: 14px;">Level up your skills. Earn points. Unlock achievements.</p>
    {% if user %}
        <p style="margin: 10px 0 24px; color:#444">Welcome, <strong>{{ user[1] }}</strong>!</p>
    {% endif %}

    <!-- Heads-up display (HUD) -->
    <div class="hud">
        <div class="badge score">Rating: <span>{{ user[4] if user[4] else 1000 }}</span></div>
        <div class="badge level">Matches: <span>{{ user[5] if user[5] else 0 }}</span></div>
        <div class="badge streak">Wins: <span>{{ user[6] if user[6] else 0 }}</span> üèÜ</div>
    </div>

    <!-- Game Cards -->
    <div class="game-grid">
        <div class="game-card">
            <div class="card-icon">‚öîÔ∏è</div>
            <h3>Quiz Battle</h3>
            <p>Challenge players in 1v1 quiz matches.</p>
            <a class="btn btn-dark" href="/quiz">Play Now</a>
        </div>

        <div class="game-card">
            <div class="card-icon">üèÜ</div>
            <h3>Leaderboard</h3>
            <p>View top players and rankings.</p>
            <a class="btn btn-dark" href="/leaderboard">View</a>
        </div>

        <div class="game-card">
            <div class="card-icon">üòä</div>
            <h3>Your Profile</h3>
            <p>View stats and update your profile.</p>
            <a class="btn btn-dark" href="/profile">Profile</a>
        </div>

        <div class="game-card">
            <div class="card-icon">üìä</div>
            <h3>Your Stats</h3>
            <p>Total XP: {{ user[7] if user[7] else 0 }}</p>
            <a class="btn btn-outline" href="/profile">Details</a>
        </div>
    </div>
</div>

<script>
// Comprehensive back button and swipe prevention
(function() {
    // Replace current history entry
    if (window.history && window.history.replaceState) {
        window.history.replaceState(null, null, window.location.href);
    }
    
    // Prevent back navigation
    window.addEventListener('popstate', function(event) {
        window.history.pushState(null, null, window.location.href);
    });
    
    // Push initial state
    window.history.pushState(null, null, window.location.href);
})();

// Prevent page from being cached
window.addEventListener('pageshow', function(event) {
    if (event.persisted) {
        window.location.reload();
    }
});

// Prevent swipe gestures from navigating back
window.addEventListener('load', function() {
    window.history.pushState(null, null, window.location.href);
});

// Additional protection against back navigation
window.onbeforeunload = function() {
    window.history.pushState(null, null, window.location.href);
};
</script>

{% endblock %}
