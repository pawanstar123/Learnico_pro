{% extends 'app.html' %}
{% block title %}Login - Learnico{% endblock %}
{% block content %}

<div class="header-section">
</div>

<div class="auth-card">
    <h2 style="text-align: center; color: #6200ff; margin-bottom: 8px; font-size: 24px;">Login</h2>
    <p style="text-align: center; color: #666; margin-bottom: 20px; font-size: 14px;">Welcome back! Login to continue</p>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert {{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <form action="/login" method="POST">

        <!-- Email -->
        <div class="input-box">
            <i class="icon-left">âœ‰ï¸</i>
            <input type="text" name="username" placeholder="Email or Username" required>
        </div>

        <!-- Password -->
        <div class="input-box">
            <i class="icon-left">ğŸ”’</i>
            <input type="password" id="password" name="password" placeholder="Password" required>
            <i class="icon-right" onclick="togglePass('password')">ğŸ‘ï¸</i>
        </div>

        <button class="auth-btn">Login</button>

        <p>Don't have an account? <a href="/register">Register</a></p>
    </form>
</div>

<script>
function togglePass(id) {
    let input = document.getElementById(id);
    input.type = input.type === "password" ? "text" : "password";
}

// Prevent caching and force server check
window.addEventListener('pageshow', function(event) {
    if (event.persisted || performance.navigation.type === 2) {
        // Page was loaded from cache (back/forward button)
        window.location.reload();
    }
});

// Disable browser back/forward cache
window.onpageshow = function(event) {
    if (event.persisted) {
        window.location.reload();
    }
};
</script>

{% endblock %}
